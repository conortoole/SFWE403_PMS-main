import tkinter as tk
from models.Customer import Customer
from models.Staff import PharmacyManager

# # Selecting GUI theme - dark, light , system (for system default) 
# tk.set_appearance_mode("dark") 
  
# # Selecting color theme - blue, green, dark-blue 
# tk.set_default_color_theme("blue") 

manager = PharmacyManager("test")
customer = Customer()

window = tk.Tk()
window.geometry("500x500") 
window.title("Update Customer") 

button = tk.Button(
    text="update",
    width=20,
    height=5,
    bg="blue",
    fg="yellow",
)

button2 = tk.Button(
    text="load customer",
    width=20,
    height=5,
    bg="blue",
    fg="yellow",
)
# labels are text
label = tk.Label(window,text="What is the ID of the Customer?") 
label1 = tk.Label(window,text="First Name") 
label2 = tk.Label(window,text="Last Name") 
label3 = tk.Label(window,text="DOB in yyyy-mm-dd") 

success = tk.Label(window,text="Successfully Added!", fg="green")  
failure = tk.Label(window,text="Failed to Load Customer!", fg = "red") 
#These are the input fields
customerID = tk.Entry(fg="yellow", bg="gray", width=50)
firstNameIn = tk.Entry(fg="yellow", bg="gray", width=50)
lastNameIn = tk.Entry(fg="yellow", bg="gray", width=50)
bDayIn = tk.Entry(fg="yellow", bg="gray", width=50)
adressIn = tk.Entry(fg="yellow", bg="gray", width=50)
phoneIn = tk.Entry(fg="yellow", bg="gray", width=50)
emailIn = tk.Entry(fg="yellow", bg="gray", width=50)
insuranceIn = tk.Entry(fg="yellow", bg="gray", width=50)
#this adds inputs to window
label.pack(pady=5)
customerID.pack(pady = 20)
button2.pack(pady = 10)
# label1.pack()
# firstNameIn.pack() 
# label2.pack()
# lastNameIn.pack() 
# label3.pack()
# bDayIn.pack() 
# adressIn.pack() 
# phoneIn.pack() 
# emailIn.pack() 
# insuranceIn.pack() 
# button.pack(pady = 20)

def load(event):
    try:
        iD = customerID.get()
        var = manager.fetchCustomer()
    except:
        failure.pack() 


def update(event): 
    # this gets info from input and puts into class
    customer.first_name = firstNameIn.get()
    customer.last_name = lastNameIn.get()
    customer.date_of_birth = bDayIn.get()
    customer.address = adressIn.get()
    customer.phone = phoneIn.get()
    customer.email = emailIn.get()
    customer.insurance = insuranceIn.get()
    #this adds the customer to database and checks if it worked
    test = manager.createPatient(customer)
    if test:
        failure.pack_forget() #removes from screen
        success.pack(pady = 20) #adds to screen 
        #clears input fields
        clear_text(firstNameIn)
        clear_text(lastNameIn)
        clear_text(bDayIn)
        clear_text(adressIn)
        clear_text(phoneIn)
        clear_text(emailIn)
        clear_text(insuranceIn)
    else:
        success.pack_forget()
        failure.pack(pady = 20) 

def clear_text(text):
   text.delete(0, tk.END)

button.bind("<Button-1>", update) #connects function handle_click to button 
button2.bind("<Button-1>", load)

window.mainloop() #constant loop for gui 